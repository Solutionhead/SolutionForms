<section class="col-sm-8 col-sm-offset-2 col-md-6  col-md-offest-3 col-lg-6 col-lg-offset-3">
  <div data-bind="visible: viewState.showEnterpriseUI">
    <h1>Enterprise Code</h1>
    <dynamic-form params="formId: 'enterprise', exports: enterpriseVm"></dynamic-form>

    <div class="row">
      <div class="col-sm-10 col-sm-offset-2">
        <button class="btn btn-default" data-bind="command: commands.acceptEnterpriseCodeCommand, css: { 'btn-primary': commands.acceptEnterpriseCodeCommand.canExecute }"><i class="fa fa-check-circle-o"></i> Accept</button>
      </div>
    </div>
  </div>

  <div data-bind="visible: !viewState.showEnterpriseUI()">
    <div class="panel panel-primary">
      <div class="panel-heading">
        <div class="pull-right">
          <button class="btn btn-default" data-bind="command: commands.changeEnterpriseCodeCommand">
            <i class="fa fa-pencil"></i>
            Change <span class="hidden-xs hidden-sm">Enterprise</span> <span class="hidden-xs hidden-sm hidden-md">Code</span>
          </button>
        </div>
        <span data-bind="with: model.enterprise">{{ activity }} @ {{ farmName }}, {{ fieldCode }} <br/> {{ productionDate | longDate }} </span>
      </div>

      <div class="panel-body">

        <section data-bind="visible: viewState.showEmployeeTicketScannerStep">
          <h3><i class="fa fa-barcode"></i> Scan Employee Ticket</h3>
          <div data-bind="visible: !model.workTicket()">
            <div data-bind="component: { name: 'form-field', params: config.ticketScannerConfig }"></div>
          </div>
          <div data-bind="visible: model.workTicket() && !model.employee()">
            <h4>No. {{ model.ticketNumber }}</h4>
            <p class="bg-info"><i class="fa fa-info-circle"></i> This ticket has not been assigned.</p>
            <div data-bind="component: { name: 'form-field', params: config.employeeLookupConfig }"></div>
          </div>
        </section>

        <section data-bind="visible: viewState.showToteStep">
          <h4>No. {{ model.ticketNumber }}</h4>
          <div>
            <div>
              <div class="pull-right">
                <button data-bind="command: commands.rescanTicketCommand" class="btn btn-default btn-sm">
                <i class="fa fa-ban"></i> Rescan <span class="hidden-sm hidden-xs hidden-md">Employee</span> <span class="hidden-xs hidden-sm">Ticket</span></button>
              </div>

              <h2 data-bind="with: model.employee">{{ name }} <i class="fa fa-check-circle text-success"></i></h2>              
            </div>
          </div>

          <div data-bind="visible: viewState.displayToteScanner">
            <h3><i class="fa fa-barcode"></i> Scan Tote</h3>
            <div data-bind="component: { name: 'form-field', params: config.toteScannerConfig }"></div>
            <button data-bind="command: commands.toggleToteScanner" class="btn btn-default"><i class="fa fa-keyboard-o"></i> Enter Tote #</button>
          </div>

          <div data-bind="visible: viewState.displayToteEntry">
            <h3><i class="fa fa fa-keyboard-o"></i> Enter Tote Number</h3>
            <div class="input-group">
              <input data-bind="value: model.toteNumber" placeholder="Enter tote number..." class="form-control" />
              <span class="input-group-btn">
                <button data-bind="command: commands.toggleToteScanner" class="btn btn-default"><i class="fa fa-barcode"></i> Scan Barcode</button>
              </span>
            </div>
          </div>

          <div data-bind="visible: model.toteNumber">
            <div>
              <div id="tote-reco-image" class="thumbnail" style="text-align: center">
                <img src="{{ model.toteScanImageData }}" />
                <h4 class="fa-3x">{{ model.toteNumber }}</h4>
              </div>
            </div>
            <div class="text-right">
              <button class="btn btn-default" data-bind="command: commands.rescanToteCommand"><i class="fa fa-ban"></i> Rescan Tote</button>
            </div>
          </div>

        </section>
      </div>

      <div class="panel-footer form-inline">
        <button class="btn btn-primary" data-bind="command: commands.saveProductionEntryCommand"><i class="fa fa-save"></i> Save</button>
        <div class="checkbox">
          <label>
            <input type="checkbox" data-bind="checked: preserveEmployee" /> Next tote is for same employee
          </label>
        </div>
      </div>
    </div>
  </div>
</section>

<div data-bind="modal: viewState.displayError().title" class="modal fade" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header" data-bind="css: { 'bg-warning': viewState.displayError().level === 'warning', 'bg-danger': viewState.displayError().level === 'critical' }">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">{{ viewState.displayError().title }}</h4>
      </div>
      <div class="modal-body">{{{ viewState.displayError().bodyMessage }}}</div>
      <div class="modal-footer">        
        {{ #if: viewState.displayError().level === 'critical' }} 
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button> 
        {{ /if }}
        
        {{ #ifnot: viewState.displayError().level === 'critical' }} 
        <button type="button" class="btn btn-warning" data-dismiss="modal">OK</button>
        {{ /if }}
      </div>
    </div>
  </div>
</div>